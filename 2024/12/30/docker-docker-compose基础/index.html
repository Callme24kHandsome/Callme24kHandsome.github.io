<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="docker、docker-compose基础学习">
<meta property="og:type" content="article">
<meta property="og:title" content="docker-docker-compose基础">
<meta property="og:url" content="http://example.com/2024/12/30/docker-docker-compose%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="24khandsome&#39;s Blog">
<meta property="og:description" content="docker、docker-compose基础学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20241222210224661.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/3e74d992a805546fa7819562436396fa.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/9184d6bcf25b343837abd4562f4a9d68.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/94859c15deb3ab31e8c48f459f939389.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/c1dbf01fdabaf8feb96186744a1b55c6.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/52575e34aa6632aa6e70eeca27b4785f.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250105214333487.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250105214632792.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/7845794741e8fbd228c12dd902f13020.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/ba22affc29feb98f287c6e0fe3d55de8-1736088879639.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/0b83310fabe80f5428dea313bb2c5791.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/83e076992ac1c4de38bf3074de7cb686.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250123230935986.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/870f7f09e9c11aae5b84dd43427b07eb.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250106222458708.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/980b9291e0e0e0bb7763f029ad85a15c.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/50740c6a04ef55769fe50513b9babb1a.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/43709643b2d36ce19323f02b1bf484b0.png">
<meta property="og:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250122225932814.png">
<meta property="article:published_time" content="2024-12-30T13:00:00.000Z">
<meta property="article:modified_time" content="2025-01-23T15:10:42.795Z">
<meta property="article:author" content="24khandsome">
<meta property="article:tag" content="计算机基础">
<meta property="article:tag" content="docker">
<meta property="article:tag" content="vmware">
<meta property="article:tag" content="虚拟机">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20241222210224661.png">

<link rel="canonical" href="http://example.com/2024/12/30/docker-docker-compose%E5%9F%BA%E7%A1%80/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>docker-docker-compose基础 | 24khandsome's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">24khandsome's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">24khandsome's Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/30/docker-docker-compose%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="24khandsome">
      <meta itemprop="description" content="24khandsome's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="24khandsome's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          docker-docker-compose基础
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-30 21:00:00" itemprop="dateCreated datePublished" datetime="2024-12-30T21:00:00+08:00">2024-12-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-23 23:10:42" itemprop="dateModified" datetime="2025-01-23T23:10:42+08:00">2025-01-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          
            <div class="post-description">docker、docker-compose基础学习</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Docker基础"><a href="#Docker基础" class="headerlink" title="Docker基础"></a>Docker基础</h1><p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20241222210224661.png" alt="image-20241222210224661"></p>
<h2 id="Docker是什么"><a href="#Docker是什么" class="headerlink" title="Docker是什么"></a>Docker是什么</h2><p>​    <strong>Docker 是一个开源的容器化平台，用于开发、交付和运行应用程序。</strong>如图所示，简单来说，docker是一艘运载着许多相互隔离、互相独立的集装箱，每个箱子内部运行着独立的程序。</p>
<h2 id="为什么使用Docker"><a href="#为什么使用Docker" class="headerlink" title="为什么使用Docker"></a>为什么使用Docker</h2><p>​    Develop faster. Run anywhere，这是docker官网上的docker原话，更快的开发，到处运行。</p>
<p><strong>1、解决传统环境差异导致的兼容性问题</strong></p>
<p>按照传统开发模式，一个产品有2套部署环境：本地开发，线上环境，存在大量的运维部署问题和环境差异，费事费力。最典型的问题是开发人员——我本地明明跑起来正常的，为什么线上不行</p>
<p><strong>2、快速部署、快速迭代的兴起</strong></p>
<p>Devops的快速发展，传统的开发模式时，开发人员提供jar包，然后手动上传服务器，然后java -jar启动新的包，有时遇到，依赖的其他组件升级，那就更是麻烦，比如mysql、redis、xxljob等，涉及到了环境依赖、先后问题，运维难度极大。有了docker，结合Jenkins、可以快速实现持续开发、持续部署、编排容器。</p>
<p><strong>3、容器编排技术的兴起</strong></p>
<p>通过容器编排工具和 Docker 的结合，可以轻松地实现复杂的应用架构，如微服务架构，多个微服务可以分别打包成 Docker 容器，通过容器编排工具进行统一管理和调度</p>
<p><strong>4、资源利用和成本优化</strong></p>
<p>Docker 容器相比于传统的虚拟机，具有更轻量级的特点。虚拟机需要为每个实例运行一个完整的操作系统，而 Docker 容器共享主机操作系统内核，多个容器可以在同一主机上运行，大大减少了系统资源的占用。这使得在相同的硬件资源下，可以部署更多的应用，提高了资源利用率，降低了企业的硬件采购和运维成本。</p>
<h2 id="Docker和虚拟机的区别"><a href="#Docker和虚拟机的区别" class="headerlink" title="Docker和虚拟机的区别"></a>Docker和虚拟机的区别</h2><p>docker出现之前，虚拟技术主流就是虚拟机，对应的软件有Vmvare，VirtualBox等。</p>
<p>总的来说，docker不像虚拟机那么重，容器共用宿主机的操作系统，每个容器只需要包含自身需要的环境和程序，所以<strong>比较小</strong>，<strong>启动也快</strong>，<strong>资源利用率更高</strong></p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/3e74d992a805546fa7819562436396fa.png" alt="什么是docker，它与虚拟机有什么区别？_docker和虚拟机的区别-CSDN博客"></p>
<p><strong>应用更快速的交付和部署</strong><br>传统：一堆帮助文档，安装程序<br>Docker：打包镜像发布测试，一键运行</p>
<p><strong>更便捷的升级和扩缩容</strong><br>使用了Docker之后，我们部署应用就和搭积木一样！<br>项目打包为一个镜像，扩展服务器A！服务器B</p>
<p><strong>更简单的系统运维</strong><br>在容器化之后，我们的开发，测试环境都是高度一致的。</p>
<p><strong>更高效的计算资源利用：</strong><br>Docker是内核级别的虚拟化，可以再一个物理机上可以运行很多的容器实例！服务器的性能可以被压榨到极致。</p>
<h2 id="Docker怎么用"><a href="#Docker怎么用" class="headerlink" title="Docker怎么用"></a>Docker怎么用</h2><h3 id="docker核心概念"><a href="#docker核心概念" class="headerlink" title="docker核心概念"></a>docker核心概念</h3><h4 id="镜像（image）"><a href="#镜像（image）" class="headerlink" title="镜像（image）"></a><strong>镜像（image）</strong></h4><p>​    Docker镜像就好比是一个模板，可以通过这个模板来创建容器服务，tomcat镜像 =&gt; run =&gt; tomcat01容器， 通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）</p>
<h4 id="容器（container）"><a href="#容器（container）" class="headerlink" title="容器（container）"></a>容器（container）</h4><p>​    Docker利用容器技术，独立运行一个或者一组应用， 通过镜像来创建的。可以理解为容器是镜像的实例</p>
<p>容器可以启动，停止，删除等</p>
<h4 id="仓库（repository）"><a href="#仓库（repository）" class="headerlink" title="仓库（repository）"></a>仓库（repository）</h4><p>​    存放镜像的地方，Docker Hub（默认是国外的），各大厂商也有自己的docker镜像仓库</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/9184d6bcf25b343837abd4562f4a9d68.png" alt="img"></p>
<h3 id="docker底层原理"><a href="#docker底层原理" class="headerlink" title="docker底层原理"></a>docker底层原理</h3><h4 id="docker如何工作"><a href="#docker如何工作" class="headerlink" title="docker如何工作"></a>docker如何工作</h4><p>​    Docker是一个Client-Server结构的服务器，Docker的守护进程运行在主机上，通过Socket从客户端访问！Docker-Server接收到Docker-Client指令，就会执行这个命令</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/94859c15deb3ab31e8c48f459f939389.png" alt="img"></p>
<h4 id="docker为什么比VM快"><a href="#docker为什么比VM快" class="headerlink" title="docker为什么比VM快"></a>docker为什么比VM快</h4><p>1、Docker有着比虚拟机更少的抽象层<br>2、docker利用的是宿主机的内核，vm需要是Guest os</p>
<p>​    所以说，新建一个容器的时候，docker不需要想虚拟机一样重新加载一个操作系统内核，避免引导。虚拟机是加载 GuestOS，分钟级别的，而docker是利用宿主机的操作系统吗，省略了这个复杂的过程，秒级！</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/c1dbf01fdabaf8feb96186744a1b55c6.png" alt="img"></p>
<h3 id="docker安装及镜像仓库配置"><a href="#docker安装及镜像仓库配置" class="headerlink" title="docker安装及镜像仓库配置"></a>docker安装及镜像仓库配置</h3><p>参考上篇</p>
<h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/52575e34aa6632aa6e70eeca27b4785f.png" alt="在这里插入图片描述"></p>
<h3 id="帮助命令："><a href="#帮助命令：" class="headerlink" title="帮助命令："></a>帮助命令：</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker version		#查看docker版本信息<br>docker info			#显示docker系统信息，包括镜像和容器的数量<br>docker --<span class="hljs-built_in">help</span>		#帮助命令<br></code></pre></td></tr></table></figure>

<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker images 查看所有本地主机上的镜像<br>-a:列出本地所有镜像<br>-q:只列出镜像ID<br>–digests:显示镜像的摘要信息<br>–no trunc:显示完整的镜像信息<br>-s:列出收藏数不小于指定值的镜像<br><br>docker search 查找镜像<br><br>docker pull 镜像名[:tag] 下拉镜像 如果不写tag，默认就是latest<br><br>docker rmi 删除镜像<br><br>docker rmi $(docker images -aq)   # 删除所有镜像<br></code></pre></td></tr></table></figure>

<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker run [可选参数] image #运行镜像<br> <br># 参数说明<br>--name=“Name”   容器名字    tomcat01    tomcat02    用来区分容器<br>-d      后台方式运行<br>-it     使用交互方式运行，进入容器查看内容<br>-p      指定容器的端口     -p <span class="hljs-number">8080</span>:<span class="hljs-number">8080</span><br>    -p  ip:主机端口：容器端口<br>    -p  主机端口：容器端口（常用）<br>    -p  容器端口<br>    容器端口<br>-p      随机指定端口<br> <br> <br># 测试，启动并进入容器<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -it centos /bin/bash<br>[root@<span class="hljs-number">74</span>e82b7980e7 /]# ls   # 查看容器内的centos，基础版本，很多命令是不完善的<br>bin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var<br>dev  home  lib64  media       opt  root  sbin  sys  usr<br> <br># 从容器中退回主机<br>[root@<span class="hljs-number">77969</span>f5dcbf9 /]# <span class="hljs-keyword">exit</span><br><span class="hljs-keyword">exit</span><br><br>列出所有的运行的容器<br># docker ps  #列出本地运行的容器<br>        # 列出当前正在运行的容器<br>-a      # 列出正在运行的容器包括历史容器<br>-n=?    # 显示最近创建的容器<br>-q      # 只显示当前容器的编号<br>退出容器<br><span class="hljs-keyword">exit</span>            # 直接退出容器并关闭<br>Ctrl + P + Q    # 容器不关闭退出<br><br>删除容器<br>docker rm -f 容器id                       # 删除指定容器<br>docker rm -f $(docker ps -aq)       # 删除所有容器<br>docker ps -a -q|xargs docker rm -f  # 删除所有的容器<br><br>启动和停止容器的操作<br>docker <span class="hljs-built_in">start</span> 容器id           # 启动容器<br>docker restart 容器id         # 重启容器<br>docker stop 容器id            # 停止当前正在运行的容器<br>docker kill 容器id            # 强制停止当前的容器<br><br>显示日志<br>docker logs -tf --tail number 容器id<br>-tf                 # 显示日志<br>--tail number       # 显示日志条数<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker logs -tf --tail <span class="hljs-number">10</span> a0d580a21251<br><br>查看容器中进程信息ps<br># 命令 docker top 容器id<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ /]# docker top df358bc06b17    <br><br>查看镜像的元数据<br>docker inspect 容器id<br><br><br>进入当前正在运行的容器<br>docker exec -it 容器id /bin/bash<br>docker attach 容器id<br><br># docker exec       # 进入容器后开启一个新的终端，可以在里面操作<br># docker attach     # 进入容器正在执行的终端，不会启动新的进程<br><br><br>从容器中拷贝文件到主机<br>docker cp 容器id：容器内路径    目的地主机路径<br>#docker cp <span class="hljs-number">7</span>af535f807e0:/home/Test.java /home<br><br>提交容器成为一个新的副本<br>docker commit<br>docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者名&quot; 容器id 目标镜像名：[tag]<br></code></pre></td></tr></table></figure>

<h2 id="Docker部署软件实战"><a href="#Docker部署软件实战" class="headerlink" title="Docker部署软件实战"></a>Docker部署软件实战</h2><h3 id="1、安装Nginx"><a href="#1、安装Nginx" class="headerlink" title="1、安装Nginx"></a>1、安装Nginx</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs CMD"># <span class="hljs-number">1</span>. 搜索镜像 search 建议去docker hub搜索，可以看到帮助文档<br># <span class="hljs-number">2</span>. 下载镜像 pull<br># <span class="hljs-number">3</span>. 运行测试<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker images<br>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br>centos              latest              <span class="hljs-number">0</span>d120b6ccaa8        <span class="hljs-number">32</span> hours ago        <span class="hljs-number">215</span>MB<br>nginx               latest              <span class="hljs-number">08393</span>e824c32        <span class="hljs-number">7</span> days ago          <span class="hljs-number">132</span>MB<br> <br># -d 后台运行<br># -name 给容器命名<br># -p 宿主机端口：容器内部端口<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d --name nginx01 -p <span class="hljs-number">3344</span>:<span class="hljs-number">80</span> nginx  # 后台方式启动启动镜像<br>fe9dc33a83294b1b240b1ebb0db9cb16bda880737db2c8a5c0a512fc819850e0<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker ps<br>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES<br>fe9dc33a8329        nginx               &quot;/docker-entrypoint.…&quot;   <span class="hljs-number">4</span> seconds ago       Up <span class="hljs-number">4</span> seconds        <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>:<span class="hljs-number">3344</span>-&gt;<span class="hljs-number">80</span>/tcp   nginx01<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:<span class="hljs-number">3344</span>    # 本地访问测试<br> <br># 进入容器<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker exec -it nginx01 /bin/bash<br><span class="hljs-function">root@fe9dc33a8329:/# <span class="hljs-title">whereis</span> <span class="hljs-title">nginx</span></span><br><span class="hljs-function"><span class="hljs-title">nginx</span>: /<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nginx</span> /<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">nginx</span> /<span class="hljs-title">etc</span>/<span class="hljs-title">nginx</span> /<span class="hljs-title">usr</span>/<span class="hljs-title">share</span>/<span class="hljs-title">nginx</span></span><br><span class="hljs-function"><span class="hljs-title">root</span>@<span class="hljs-title">fe9dc33a8329</span>:/# <span class="hljs-title">cd</span> /<span class="hljs-title">etc</span>/<span class="hljs-title">nginx</span>/</span><br><span class="hljs-function"><span class="hljs-title">root</span>@<span class="hljs-title">fe9dc33a8329</span>:/<span class="hljs-title">etc</span>/<span class="hljs-title">nginx</span># <span class="hljs-title">ls</span></span><br><span class="hljs-function"><span class="hljs-title">conf.d</span>      <span class="hljs-title">koi</span>-<span class="hljs-title">utf</span>  <span class="hljs-title">mime.types</span>  <span class="hljs-title">nginx.conf</span>   <span class="hljs-title">uwsgi_params</span></span><br><span class="hljs-function"><span class="hljs-title">fastcgi_params</span>  <span class="hljs-title">koi</span>-<span class="hljs-title">win</span>  <span class="hljs-title">modules</span>     <span class="hljs-title">scgi_params</span>  <span class="hljs-title">win</span>-<span class="hljs-title">utf</span></span><br></code></pre></td></tr></table></figure>



<h3 id="2、安装Tomcat"><a href="#2、安装Tomcat" class="headerlink" title="2、安装Tomcat"></a>2、安装Tomcat</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs CMD"># 官方的使用<br>docker run -it --rm tomcat:<span class="hljs-number">9</span>.<span class="hljs-number">0</span><br> <br># 我们之前的启动都是后台的，停止了容器之后， 容器还是可以查到，docker run -it --rm 一般用来测试，用完就删<br> <br># 下载再启动<br>docker pull tomcat<br> <br># 启动运行<br>docker run -d -p <span class="hljs-number">3344</span>:<span class="hljs-number">8080</span> --name tomcat01 tomcat<br> <br># 测试访问没有问题<br> <br># 进入容器<br>docker exec -it tomcat01 /bin/bash<br> <br># 发现问题：<span class="hljs-number">1</span>.linux命令少了， <span class="hljs-number">2</span>. webapps下内容为空 默认是最小的镜像，所有不必要的都剔除了，保证最小可运行环境即可<br></code></pre></td></tr></table></figure>

<h3 id="3、ES-Kibana"><a href="#3、ES-Kibana" class="headerlink" title="3、ES+Kibana"></a>3、ES+Kibana</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs CMD"># es 暴露的端口很多<br># es 十分的耗内存<br># es 的数据一般需要放置到安全目录！ 挂载<br># --<span class="hljs-built_in">net</span> somenetwork 网络配置<br> <br># 启动elasticsearch<br>docker run -d --name elasticsearch --<span class="hljs-built_in">net</span> somenetwork -p <span class="hljs-number">9200</span>:<span class="hljs-number">9200</span> -p <span class="hljs-number">9300</span>:<span class="hljs-number">9300</span> -e &quot;discovery.<span class="hljs-built_in">type</span>=single-node&quot; elasticsearch:<span class="hljs-number">7</span>.<span class="hljs-number">6</span>.<span class="hljs-number">2</span><br> <br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# docker run -d --name elasticsearch -p <span class="hljs-number">9200</span>:<span class="hljs-number">9200</span> -p <span class="hljs-number">9300</span>:<span class="hljs-number">9300</span> -e &quot;discovery.<span class="hljs-built_in">type</span>=single-node&quot; elasticsearch:<span class="hljs-number">7</span>.<span class="hljs-number">6</span>.<span class="hljs-number">2</span><br>a920894a940b354d3c867079efada13d96cf9138712c76c8dea58fabd9c7e96f<br> <br># 启动了linux就卡主了，docker stats 查看cpu状态<br> <br># 测试一下es成功了<br>[root@iZ2zeg4ytp0whqtmxbsqiiZ home]# curl localhost:<span class="hljs-number">9200</span><br>&#123;<br>  &quot;name&quot; : &quot;a920894a940b&quot;,<br>  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,<br>  &quot;cluster_uuid&quot; : &quot;bxE1TJMEThKgwmk7Aa3fHQ&quot;,<br>  &quot;version&quot; : &#123;<br>    &quot;number&quot; : &quot;<span class="hljs-number">7</span>.<span class="hljs-number">6</span>.<span class="hljs-number">2</span>&quot;,<br>    &quot;build_flavor&quot; : &quot;default&quot;,<br>    &quot;build_type&quot; : &quot;docker&quot;,<br>    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,<br>    &quot;build_date&quot; : &quot;<span class="hljs-number">2020</span>-<span class="hljs-number">03</span>-<span class="hljs-number">26</span>T06:<span class="hljs-number">34</span>:<span class="hljs-number">37</span>.<span class="hljs-number">794943</span>Z&quot;,<br>    &quot;build_snapshot&quot; : false,<br>    &quot;lucene_version&quot; : &quot;<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>&quot;,<br>    &quot;minimum_wire_compatibility_version&quot; : &quot;<span class="hljs-number">6</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>&quot;,<br>    &quot;minimum_index_compatibility_version&quot; : &quot;<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>-beta1&quot;<br>  &#125;,<br>  &quot;tagline&quot; : &quot;You Know, <span class="hljs-keyword">for</span> Search&quot;<br>&#125;<br> <br> <br># 增加内存限制，修改配置文件 -e 环境配置修改<br>docker run -d --name elasticsearch -p <span class="hljs-number">9200</span>:<span class="hljs-number">9200</span> -p <span class="hljs-number">9300</span>:<span class="hljs-number">9300</span> -e &quot;discovery.<span class="hljs-built_in">type</span>=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:<span class="hljs-number">7</span>.<span class="hljs-number">6</span>.<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>



<h2 id="镜像讲解"><a href="#镜像讲解" class="headerlink" title="镜像讲解"></a>镜像讲解</h2><p>​    镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含某个软件所需的所有内容，包括代码、库、环境变量和配合文件。</p>
<p><strong>UnionFS(联合文件系统)</strong></p>
<p>​    UnionFS(联合文件系统):Union文件系统(UnionFS)是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。</p>
<p>​    UnionFS 文件系统是Docker镜像的基础。镜像可以通过分层来进行继承,基于基础镜像(没有父镜像),可以制作各种具体的应用镜像。</p>
<p><strong>分层理解</strong></p>
<p>​    所有的 Docker镜像都起始于一个基础镜像层,当进行修改或增加新的内容时，就会在当前镜像层之上，创建新的镜像层。举一个简单的例子,假如基于 Ubuntu Linux 16.04创建一个新的镜像,这就是新镜像的第一层;如果在该镜像中添加 Python包就会在基础镜像层之上创建第二个镜像层;如果继续添加一个安全补丁，就会创建第三个镜像层。该镜像当前已经包含3个镜像层，如下图所示(这只是一个用于演示的很简单的例子)。</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250105214333487.png" alt="image-20250105214333487"></p>
<p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部!这一层就是我们通常说的容器层，容器之下的都叫镜像层，当我们对启动后的容器继续做什么操作后打包成镜像，相当于在原镜像层的基础上，再堆叠一层。</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250105214632792.png" alt="image-20250105214632792"></p>
<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><p>问题：mysql作为容器启动产生数据后，容器重启或者关闭怎么办，数据怎么保存</p>
<h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><p>​    容器之间可以有一个数据共享的技术，docker容器中产生的数据，同步到本地</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/7845794741e8fbd228c12dd902f13020.png" alt="img"></p>
<h3 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a><strong>使用数据卷</strong></h3><p>方式一：直接使用命令来挂载，-v</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker run -it -v 主机目录:容器目录<br>[root@localhost ~]# docker run -it -v /home/ceshi:/home centos01:<span class="hljs-number">1</span>.<span class="hljs-number">0</span> /bin/bash<br></code></pre></td></tr></table></figure>

<h4 id="实战：安装MySQL"><a href="#实战：安装MySQL" class="headerlink" title="实战：安装MySQL"></a>实战：安装MySQL</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 获取镜像<br># docker pull mysql:<span class="hljs-number">5</span>.<span class="hljs-number">7</span><br> <br># 运行容器， 需要做数据挂载！ # 安装启动mysql，需要配置密码（注意）<br># 官方测试， docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag<br> <br># 启动我们的<br>-d      # 后台运行<br>-p      # 端口隐射<br>-v      # 卷挂载<br>-e      # 环境配置<br>--name  # 容器的名字<br># docker run -d -p <span class="hljs-number">3344</span>:<span class="hljs-number">3306</span> -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=<span class="hljs-number">123456</span> --name mysql01 mysql:<span class="hljs-number">5</span>.<span class="hljs-number">7</span><br><br># 启动成功之后，我们在本地使用navicat链接测试一下<br># navicat链接到服务器的<span class="hljs-number">3344</span> --- <span class="hljs-number">3344</span> 和 容器的<span class="hljs-number">3306</span>映射，这个时候我们就可以连接上mysql喽！<br> <br># 在本地测试创建一个数据库，查看下我们的路径是否ok！<br></code></pre></td></tr></table></figure>

<h4 id="具名挂载与匿名挂载"><a href="#具名挂载与匿名挂载" class="headerlink" title="具名挂载与匿名挂载"></a>具名挂载与匿名挂载</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 如何确定是具名挂载还是匿名挂载，还是指定路径挂载<br>-v 容器内路径			 #匿名挂载<br>-v 卷名:容器内路径	   		#具名挂载<br>-v  /宿主机路径:容器内路径	#指定路径挂载<br><br># 通过 -v 容器内路径:ro rw 改变读写权限<br>ro(只读) rw(可读可写)<br># 一旦设置了容器权限，容器对我们挂载出来额内容就有限定了<br>[root@localhost home]# docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx<br>[root@localhost home]# docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx<br># ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作的<br></code></pre></td></tr></table></figure>

<p>所有docker容器内的卷，没有指定目录的情况下都是在<code>/var/lib/docker/volumes/xxxxx/_data</code>我们通过具名挂载可以方便的找到我们的一个卷，大多数情况下使用的是<code>具名挂载</code></p>
<h4 id="多个mysql同步数据"><a href="#多个mysql同步数据" class="headerlink" title="多个mysql同步数据"></a>多个mysql同步数据</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs CMD">[root@localhost /]# docker run -it --name docker01 syw/centos:<span class="hljs-number">1</span>.<span class="hljs-number">0</span><br>[root@<span class="hljs-number">9998</span>f8ab8c5a /]# ls<br>bin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var       volume02<br>dev  home  lib64  media       opt  root  sbin  sys  usr  volume01<br>[root@localhost /]# docker run -it --name docker02 --volumes-from docker01 syw/centos:<span class="hljs-number">1</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>​    关键命令 –volumes-from 只要子容器挂载到父容器上就可以实现容器间的数据互相同步，第三个容器的数据也可以同步到第一、第二个容器中，可以同步多个容器就算删除docker01，docker02依然可以访问这个文件.这是容器间的拷贝的概念</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/ba22affc29feb98f287c6e0fe3d55de8-1736088879639.png" alt="img"></p>
<h2 id="Dockerfile介绍"><a href="#Dockerfile介绍" class="headerlink" title="Dockerfile介绍"></a>Dockerfile介绍</h2><p>​    <strong>dockerfile 就是用来构建docker镜像的构建文件</strong>，命令脚本，使用docker build</p>
<p>简单的Dockerfile例子</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 自己手写一个镜像<br># 创建dockerfile，名字可以随机，建议dockerfile<br># 文件中的内容 指令(大写) 参数<br>[root@localhost docker-test-volume]# cat dockerfile1 <br>FROM centos							#<br>								#这里的每一个命令，就是镜像的一层<br>VOLUME [&quot;/volume01&quot;,&quot;/volume02&quot;]<br><span class="hljs-built_in">CMD</span> <span class="hljs-built_in">echo</span> &quot;----end------&quot;<br><span class="hljs-built_in">CMD</span> /bin/bash<br># 生成镜像，docker build -f 镜像文件 -t 镜像名:[tag] .<br>[root@localhost docker-test-volume]# docker build -f dockerfile1 -t syw/centos:<span class="hljs-number">1</span>.<span class="hljs-number">0</span> .<br>docker images 就能查到刚刚构建的镜像<br></code></pre></td></tr></table></figure>

<h3 id="如何使用dockerfile"><a href="#如何使用dockerfile" class="headerlink" title="如何使用dockerfile"></a><strong>如何使用dockerfile</strong></h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">1、编写一个dockerfile文件<br>2、docker build 构建成为一个镜像<br>3、docker run运行镜像<br>4、docker push 发布镜像<br></code></pre></td></tr></table></figure>

<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/0b83310fabe80f5428dea313bb2c5791.png" alt="img"></p>
<h3 id="dockerfile搭建过程"><a href="#dockerfile搭建过程" class="headerlink" title="dockerfile搭建过程"></a><strong>dockerfile搭建过程</strong></h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">1、每个保留关键字(指令)都是必须是大写字母<br>2、执行从上到下顺序执行<br>3、#表示注释<br>4、每个指令都会创建提交一个新的镜像层，并提交<br></code></pre></td></tr></table></figure>

<h3 id="docker基本命令"><a href="#docker基本命令" class="headerlink" title="docker基本命令"></a><strong>docker基本命令</strong></h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd">FROM			#基础镜像，一切从这里开始构建<br>MAINTAINER		#镜像是谁写的，姓名+邮箱<br>RUN				#镜像运行的时候需要运行的命令<br>ADD				#步骤，tomcat镜像，这个tomcat压缩包！添加内容<br>WORKDIR			#镜像的工作目录<br>VOLUME			#挂载的目录<br>EXPOSE			#保留端口配置<br><span class="hljs-built_in">CMD</span>				#指定这个容器启动的时候需要运行的命令<br>ENTRYPOINT		#指定这个容器启动的时候需要运行的命令，可以追加命令<br>ONBUILD			#当构建一个被继承dockerfile 这个的时候就会运行ONBUILD的指令<br><span class="hljs-built_in">COPY</span>			#类似ADD，我们文件拷贝到镜像中 <br>ENV				#构建的时候设置环境变量<br></code></pre></td></tr></table></figure>

<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/83e076992ac1c4de38bf3074de7cb686.png" alt="img"></p>
<p><strong>CMD和ENTRYPOINT的区别</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">CMD</span>	#指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代<br>ENTRYPOINT #指定这个容器启动的时候需要运行的命令，可以追加命令<br>一般用ENTRYPOINT结尾<br></code></pre></td></tr></table></figure>

<p>DIY自制Centos镜像</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><br></code></pre></td></tr></table></figure>

<p>DIY自制Tomcat镜像</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><br></code></pre></td></tr></table></figure>

<h3 id="SpringBoot微服务打包Docker镜像"><a href="#SpringBoot微服务打包Docker镜像" class="headerlink" title="SpringBoot微服务打包Docker镜像"></a>SpringBoot微服务打包Docker镜像</h3><p>1、定义controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController(&quot;/test&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>&#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/aaa&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">aaa</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bbb&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>dockerfile-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">excludes</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">exclude</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">exclude</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">excludes</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>2、定义Dockerfile</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">FROM openjdk:<span class="hljs-number">8</span><br>COPY *.jar /app.jar<br>CMD [<span class="hljs-string">&quot;--server.port=8080&quot;</span>]<br>EXPOSE <span class="hljs-number">8080</span><br>ENTRYPOINT [<span class="hljs-string">&quot;java&quot;</span>,<span class="hljs-string">&quot;-jar&quot;</span>,<span class="hljs-string">&quot;/app.jar&quot;</span>]<br></code></pre></td></tr></table></figure>

<p>3、上传到linux</p>
<p>4、构建镜像</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cmd">[root@localhost Dockerfiletest]# ll<br>总用量 <span class="hljs-number">8</span><br>-rw-r--r--. <span class="hljs-number">1</span> root root  <span class="hljs-number">112</span> <span class="hljs-number">1</span>月  <span class="hljs-number">23</span> <span class="hljs-number">22</span>:<span class="hljs-number">14</span> Dockerfile<br>-rw-r--r--. <span class="hljs-number">1</span> root root <span class="hljs-number">2892</span> <span class="hljs-number">1</span>月  <span class="hljs-number">23</span> <span class="hljs-number">22</span>:<span class="hljs-number">14</span> dockerfile-test-<span class="hljs-number">1</span>.<span class="hljs-number">0</span>-SNAPSHOT.jar<br>[root@localhost Dockerfiletest]# docker build -t testdockerfile .<br>[root@localhost Dockerfiletest]# docker images<br>REPOSITORY                                          TAG                IMAGE ID       CREATED              SIZE<br>testdockerfile                                      latest             f584d98b0712   About a minute ago   <span class="hljs-number">526</span>MB<br></code></pre></td></tr></table></figure>

<p>5、启动容器</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker run -d -p <span class="hljs-number">8080</span>:<span class="hljs-number">8080</span> --name testdockerfile testdockerfile<br></code></pre></td></tr></table></figure>

<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250123230935986.png" alt="image-20250123230935986"></p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/870f7f09e9c11aae5b84dd43427b07eb.png" alt="img"></p>
<h2 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h2><p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250106222458708.png" alt="image-20250106222458708"></p>
<p>如上所示，只要装了docker，就会给本机新增一个docker0的网卡。</p>
<p><strong>容器内网络情况</strong></p>
<p><strong>思考： 宿主机能不能ping通容器？</strong>可以相互ping</p>
<p><strong>原理</strong>:我们每启动一个docker容器， docker就会给docker容器分配一个ip， 我们只要安装了docker，就会有一个网卡 docker0桥接模式，使用的技术是veth-pair技术！</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs CMD"># 我们发现这个容器带来的网卡都是一对对的，<br># evth-pair 就是一对虚拟设备接口，它们都是成对出现的，一段连着协议，一段彼此相连<br># 正因为这个特性，evth-pair充当一个桥梁，连接各种虚拟网络设备<br># OpenStack，docker容器间的连接，OVS的连接，都是使用evth-pair 技术<br></code></pre></td></tr></table></figure>

<p><strong>思考：tomcat01、tomcat02 是否可以ping通？</strong>可以</p>
<p>结论：tomcat01和tomcat02是共用一个路由器，docker0</p>
<p>所有容器不指定网络的情况下，都是docker0来路由的，docker会给我们的容器分配一个默认的可用ip，因此tomcat01可以ping通tomcat02</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/980b9291e0e0e0bb7763f029ad85a15c.png" alt="img"></p>
<p>Docker使用的是linux的桥接，宿主机是一个docker容器的网桥</p>
<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/50740c6a04ef55769fe50513b9babb1a.png" alt="img"></p>
<h3 id="link（不适用当前）"><a href="#link（不适用当前）" class="headerlink" title="link（不适用当前）"></a>link（不适用当前）</h3><p>思考一个场景，我们编写了一个微服务，database url=ip: ,项目不重启，数据库ip换掉，我们希望可以处理这个问题，可以名字来进行访问容器。不用网络地址可以ping通</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">[root@localhost ~]# docker exec -it tomcat01 <span class="hljs-built_in">ping</span> tomcat02<br><span class="hljs-function">ping: <span class="hljs-title">tomcat02</span>: <span class="hljs-title">Name</span> <span class="hljs-title">or</span> <span class="hljs-title">service</span> <span class="hljs-title">not</span> <span class="hljs-title">known</span></span><br></code></pre></td></tr></table></figure>

<p>如何解决这个问题？</p>
<p><strong>添加了–link 实现容器名ping通，不需要通过网路ip</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cmd">[root@localhost ~]# docker run -d -P --name tomcat03 --link tomcat02 tomcat<br>[root@localhost ~]# docker exec -it tomcat03 <span class="hljs-built_in">ping</span> tomcat02<br><span class="hljs-number">64</span> bytes from tomcat02 (<span class="hljs-number">172</span>.<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>): icmp_seq=<span class="hljs-number">74</span> ttl=<span class="hljs-number">64</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">0</span>.<span class="hljs-number">134</span> ms<br><span class="hljs-number">64</span> bytes from tomcat02 (<span class="hljs-number">172</span>.<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>): icmp_seq=<span class="hljs-number">75</span> ttl=<span class="hljs-number">64</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">0</span>.<span class="hljs-number">156</span> ms<br># 反向不能<span class="hljs-built_in">ping</span>通<br></code></pre></td></tr></table></figure>

<p>–link就是我们在hosts配置中增加了一个 172.17.0.3 tomcat02 容器id 这种格式的host配置，但是这样写的太死了，不可持续，难以维护。</p>
<h3 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cmd">查看所有的docker网络<br>[root@localhost ~]# docker network ls<br>NETWORK ID     NAME              DRIVER    SCOPE<br>cd0629f7a781   bridge            bridge    local<br>c797f67cfda9   flink_default     bridge    local<br><span class="hljs-number">83848</span>de4da79   graylog_graylog   bridge    local<br><span class="hljs-number">0</span>d408d098017   host              host      local<br><span class="hljs-number">345</span>eb395330e   kafka_default     bridge    local<br><span class="hljs-number">6591455</span>a2f45   none              null      local<br></code></pre></td></tr></table></figure>

<p><strong>网络模式</strong></p>
<p>bridge：桥接docker （默认，自己创建的网络也是用bridge 模式）</p>
<p>none：不配置网络</p>
<p>host：和宿主机共享网络</p>
<p>container：容器网络连通（用的少，局限很大）</p>
<p>我们默认启动时其实就是默认 –net bridge，默认使用桥接的docker0这个网络</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 我们直接启动命令，--<span class="hljs-built_in">net</span> bridge,而这个就是我们的docker0<br>docker run -d -P --name tomcat01 tomcat <br>docker run -d -P --name tomcat01 --<span class="hljs-built_in">net</span> bridge tomcat		#等同于上一个命令<br></code></pre></td></tr></table></figure>

<h4 id="自定义网络-1"><a href="#自定义网络-1" class="headerlink" title="自定义网络"></a><strong>自定义网络</strong></h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs cmd">docker network create mynetwork --driver bridge --subnet <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span> --gateway <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br>mynetwork是网络名<br>--driver bridge 是网络模式<br>--subnet <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span> 子网是<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span> 前<span class="hljs-number">16</span>位是网络号，后<span class="hljs-number">16</span>位是主机号<br>--gateway <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> 网关是<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><br><br>#查看刚刚自定义的网络<br>[root@localhost ~]# docker network list<br>NETWORK ID     NAME              DRIVER    SCOPE<br>cd0629f7a781   bridge            bridge    local<br>c797f67cfda9   flink_default     bridge    local<br><span class="hljs-number">83848</span>de4da79   graylog_graylog   bridge    local<br><span class="hljs-number">0</span>d408d098017   host              host      local<br><span class="hljs-number">345</span>eb395330e   kafka_default     bridge    local<br><span class="hljs-number">6</span>cea02844ca7   mynetwork         bridge    local<br><span class="hljs-number">6591455</span>a2f45   none              null      local<br><br>#启动容器并绑定到自定义的网络<br>docker rm -f $(docker ps -aq)<br>docker run -d -p <span class="hljs-number">3344</span>:<span class="hljs-number">8080</span> --name tomcat01 --network mynetwork tomcat<br>docker run -d -p <span class="hljs-number">3345</span>:<span class="hljs-number">8080</span> --name tomcat02 --network mynetwork tomcat<br>[root@localhost ~]# docker network inspect mynetwork<br>[<br>    &#123;<br>        &quot;Name&quot;: &quot;mynetwork&quot;,<br>        &quot;Id&quot;: &quot;<span class="hljs-number">6</span>cea02844ca734056bc69f14e79fdce871d2b7f610a402d259345f7dcf294daf&quot;,<br>        &quot;Created&quot;: &quot;<span class="hljs-number">2025</span>-<span class="hljs-number">01</span>-<span class="hljs-number">21</span>T22:<span class="hljs-number">07</span>:<span class="hljs-number">18</span>.<span class="hljs-number">289053597</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>&quot;,<br>        &quot;Scope&quot;: &quot;local&quot;,<br>        &quot;Driver&quot;: &quot;bridge&quot;,<br>        &quot;EnableIPv6&quot;: false,<br>        &quot;IPAM&quot;: &#123;<br>            &quot;Driver&quot;: &quot;default&quot;,<br>            &quot;Options&quot;: &#123;&#125;,<br>            &quot;Config&quot;: [<br>                &#123;<br>                    &quot;Subnet&quot;: &quot;<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>/<span class="hljs-number">16</span>&quot;,<br>                    &quot;Gateway&quot;: &quot;<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>&quot;<br>                &#125;<br>            ]<br>        &#125;,<br>        &quot;Internal&quot;: false,<br>        &quot;Attachable&quot;: false,<br>        &quot;Ingress&quot;: false,<br>        &quot;ConfigFrom&quot;: &#123;<br>            &quot;Network&quot;: &quot;&quot;<br>        &#125;,<br>        &quot;ConfigOnly&quot;: false,<br>        &quot;Containers&quot;: &#123;<br>            &quot;<span class="hljs-number">567797</span>a34578a54334a6bb4ac39cf2fc06fc9a322b3cfb49d7956f5b04da73a8&quot;: &#123;<br>                &quot;Name&quot;: &quot;tomcat01&quot;,<br>                &quot;EndpointID&quot;: &quot;<span class="hljs-number">0</span>e85ead22dc53f01ed2fdae970d740a5811e7f6d5a51575a6c69f2514b879c1e&quot;,<br>                &quot;MacAddress&quot;: &quot;<span class="hljs-number">02</span>:<span class="hljs-number">42</span>:c0:a8:<span class="hljs-number">00</span>:<span class="hljs-number">02</span>&quot;,<br>                &quot;IPv4Address&quot;: &quot;<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>/<span class="hljs-number">16</span>&quot;,<br>                &quot;IPv6Address&quot;: &quot;&quot;<br>            &#125;,<br>            &quot;a69aeaa3bfef9e7a17b6b77538a1b9e8b9d5d67f457f1181194c3213e0ea46ab&quot;: &#123;<br>                &quot;Name&quot;: &quot;tomcat02&quot;,<br>                &quot;EndpointID&quot;: &quot;<span class="hljs-number">1</span>b45e31f53e87aed935068e6761b35488d1164f2ac9d7f45942d7f551dc427d4&quot;,<br>                &quot;MacAddress&quot;: &quot;<span class="hljs-number">02</span>:<span class="hljs-number">42</span>:c0:a8:<span class="hljs-number">00</span>:<span class="hljs-number">03</span>&quot;,<br>                &quot;IPv4Address&quot;: &quot;<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>/<span class="hljs-number">16</span>&quot;,<br>                &quot;IPv6Address&quot;: &quot;&quot;<br>            &#125;<br>        &#125;,<br>        &quot;Options&quot;: &#123;&#125;,<br>        &quot;Labels&quot;: &#123;&#125;<br>    &#125;<br>]<br><br># 不使用--link都可以<span class="hljs-built_in">ping</span>通<br>[root@localhost ~]# docker exec -it tomcat-<span class="hljs-built_in">net</span>-<span class="hljs-number">01</span> <span class="hljs-built_in">ping</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span><br>[root@localhost ~]# docker exec -it tomcat-<span class="hljs-built_in">net</span>-<span class="hljs-number">01</span> <span class="hljs-built_in">ping</span> tomcat-<span class="hljs-built_in">net</span>-<span class="hljs-number">02</span><br><br></code></pre></td></tr></table></figure>

<h4 id="网络连接"><a href="#网络连接" class="headerlink" title="网络连接"></a>网络连接</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs cmd">[root@localhost ~]# docker network connect --<span class="hljs-built_in">help</span><br><br><span class="hljs-function">Usage:  <span class="hljs-title">docker</span> <span class="hljs-title">network</span> <span class="hljs-title">connect</span> [<span class="hljs-title">OPTIONS</span>] <span class="hljs-title">NETWORK</span> <span class="hljs-title">CONTAINER</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Connect</span> <span class="hljs-title">a</span> <span class="hljs-title">container</span> <span class="hljs-title">to</span> <span class="hljs-title">a</span> <span class="hljs-title">network</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Options</span>:</span><br><span class="hljs-function">      --<span class="hljs-title">alias</span> <span class="hljs-title">strings</span>           <span class="hljs-title">Add</span> <span class="hljs-title">network</span>-<span class="hljs-title">scoped</span> <span class="hljs-title">alias</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">container</span></span><br><span class="hljs-function">      --<span class="hljs-title">driver</span>-<span class="hljs-title">opt</span> <span class="hljs-title">strings</span>      <span class="hljs-title">driver</span> <span class="hljs-title">options</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">network</span></span><br><span class="hljs-function">      --<span class="hljs-title">ip</span> <span class="hljs-title">string</span>               <span class="hljs-title">IPv4</span> <span class="hljs-title">address</span> (<span class="hljs-title">e.g</span>., &quot;172.30.100.104&quot;)</span><br><span class="hljs-function">      --<span class="hljs-title">ip6</span> <span class="hljs-title">string</span>              <span class="hljs-title">IPv6</span> <span class="hljs-title">address</span> (<span class="hljs-title">e.g</span>., &quot;2001:<span class="hljs-title">db8</span>::33&quot;)</span><br><span class="hljs-function">      --<span class="hljs-title">link</span> <span class="hljs-title">list</span>               <span class="hljs-title">Add</span> <span class="hljs-title">link</span> <span class="hljs-title">to</span> <span class="hljs-title">another</span> <span class="hljs-title">container</span></span><br><span class="hljs-function">      --<span class="hljs-title">link</span>-<span class="hljs-title">local</span>-<span class="hljs-title">ip</span> <span class="hljs-title">strings</span>   <span class="hljs-title">Add</span> <span class="hljs-title">a</span> <span class="hljs-title">link</span>-<span class="hljs-title">local</span> <span class="hljs-title">address</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">container</span></span><br><span class="hljs-function"></span><br><span class="hljs-function">[<span class="hljs-title">root</span>@<span class="hljs-title">localhost</span> ~]# <span class="hljs-title">docker</span> <span class="hljs-title">run</span> -<span class="hljs-title">d</span> -<span class="hljs-title">p</span> 3346:8080 --<span class="hljs-title">name</span> <span class="hljs-title">tomcat03</span> <span class="hljs-title">tomcat</span></span><br><span class="hljs-function"># 连接<span class="hljs-title">tomcat03</span> 到自定义网络 <span class="hljs-title">mynetwork</span> </span><br><span class="hljs-function">[<span class="hljs-title">root</span>@<span class="hljs-title">localhost</span> ~]# <span class="hljs-title">docker</span> <span class="hljs-title">network</span> <span class="hljs-title">connect</span> <span class="hljs-title">mynetwork</span> <span class="hljs-title">tomcat03</span></span><br><span class="hljs-function">[<span class="hljs-title">root</span>@<span class="hljs-title">localhost</span> ~]# <span class="hljs-title">docker</span> <span class="hljs-title">inspect</span> <span class="hljs-title">network</span> <span class="hljs-title">mynetwork</span></span><br><span class="hljs-function">[</span><br><span class="hljs-function">    &#123;</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Name</span>&quot;: &quot;<span class="hljs-title">mynetwork</span>&quot;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Id</span>&quot;: &quot;6<span class="hljs-title">cea02844ca734056bc69f14e79fdce871d2b7f610a402d259345f7dcf294daf</span>&quot;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Created</span>&quot;: &quot;2025-01-21<span class="hljs-title">T22</span>:07:18.289053597+08:00&quot;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Scope</span>&quot;: &quot;<span class="hljs-title">local</span>&quot;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Driver</span>&quot;: &quot;<span class="hljs-title">bridge</span>&quot;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">EnableIPv6</span>&quot;: <span class="hljs-title">false</span>,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">IPAM</span>&quot;: &#123;</span><br><span class="hljs-function">            &quot;<span class="hljs-title">Driver</span>&quot;: &quot;<span class="hljs-title">default</span>&quot;,</span><br><span class="hljs-function">            &quot;<span class="hljs-title">Options</span>&quot;: &#123;&#125;,</span><br><span class="hljs-function">            &quot;<span class="hljs-title">Config</span>&quot;: [</span><br><span class="hljs-function">                &#123;</span><br><span class="hljs-function">                    &quot;<span class="hljs-title">Subnet</span>&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="hljs-function">                    &quot;<span class="hljs-title">Gateway</span>&quot;: &quot;192.168.0.1&quot;</span><br><span class="hljs-function">                &#125;</span><br><span class="hljs-function">            ]</span><br><span class="hljs-function">        &#125;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Internal</span>&quot;: <span class="hljs-title">false</span>,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Attachable</span>&quot;: <span class="hljs-title">false</span>,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Ingress</span>&quot;: <span class="hljs-title">false</span>,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">ConfigFrom</span>&quot;: &#123;</span><br><span class="hljs-function">            &quot;<span class="hljs-title">Network</span>&quot;: &quot;&quot;</span><br><span class="hljs-function">        &#125;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">ConfigOnly</span>&quot;: <span class="hljs-title">false</span>,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Containers</span>&quot;: &#123;</span><br><span class="hljs-function">            &quot;1<span class="hljs-title">f85ca4a00dbf7d502ae16564d9694830c5fcff782e2afe3f28590915b8ed789</span>&quot;: &#123;</span><br><span class="hljs-function">                &quot;<span class="hljs-title">Name</span>&quot;: &quot;<span class="hljs-title">tomcat03</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">EndpointID</span>&quot;: &quot;<span class="hljs-title">e44f71b65dc14944103448e094dfe4e085cd070495eb006c4cd848e78fa8d10a</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">MacAddress</span>&quot;: &quot;02:42:<span class="hljs-title">c0:a8</span>:00:04&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv4Address</span>&quot;: &quot;192.168.0.4/16&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv6Address</span>&quot;: &quot;&quot;</span><br><span class="hljs-function">            &#125;,</span><br><span class="hljs-function">            &quot;567797<span class="hljs-title">a34578a54334a6bb4ac39cf2fc06fc9a322b3cfb49d7956f5b04da73a8</span>&quot;: &#123;</span><br><span class="hljs-function">                &quot;<span class="hljs-title">Name</span>&quot;: &quot;<span class="hljs-title">tomcat01</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">EndpointID</span>&quot;: &quot;0<span class="hljs-title">e85ead22dc53f01ed2fdae970d740a5811e7f6d5a51575a6c69f2514b879c1e</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">MacAddress</span>&quot;: &quot;02:42:<span class="hljs-title">c0:a8</span>:00:02&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv4Address</span>&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv6Address</span>&quot;: &quot;&quot;</span><br><span class="hljs-function">            &#125;,</span><br><span class="hljs-function">            &quot;<span class="hljs-title">a69aeaa3bfef9e7a17b6b77538a1b9e8b9d5d67f457f1181194c3213e0ea46ab</span>&quot;: &#123;</span><br><span class="hljs-function">                &quot;<span class="hljs-title">Name</span>&quot;: &quot;<span class="hljs-title">tomcat02</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">EndpointID</span>&quot;: &quot;1<span class="hljs-title">b45e31f53e87aed935068e6761b35488d1164f2ac9d7f45942d7f551dc427d4</span>&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">MacAddress</span>&quot;: &quot;02:42:<span class="hljs-title">c0:a8</span>:00:03&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv4Address</span>&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="hljs-function">                &quot;<span class="hljs-title">IPv6Address</span>&quot;: &quot;&quot;</span><br><span class="hljs-function">            &#125;</span><br><span class="hljs-function">        &#125;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Options</span>&quot;: &#123;&#125;,</span><br><span class="hljs-function">        &quot;<span class="hljs-title">Labels</span>&quot;: &#123;&#125;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function">]</span><br><span class="hljs-function"># 实现了跨网段用名称进行通信--这样就能<span class="hljs-title">ping</span>通了</span><br><span class="hljs-function">[<span class="hljs-title">root</span>@<span class="hljs-title">localhost</span> ~]# <span class="hljs-title">docker</span> <span class="hljs-title">exec</span> -<span class="hljs-title">it</span> <span class="hljs-title">tomcat01</span> <span class="hljs-title">ping</span> <span class="hljs-title">tomcat</span>-<span class="hljs-title">net</span>-01</span><br></code></pre></td></tr></table></figure>

<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><p>我们自定义的网络docker都已经帮我们维护好了对应的关系，推荐我们平时这样使用网络</p>
<p>好处：</p>
<p>Redis- 不同的集群使用不同的网络，保证集群是安全和健康的</p>
<p>mysql- 不同的集群使用不同的网络，保证集群是安全和健康的</p>
<h3 id="实战：部署Redis集群"><a href="#实战：部署Redis集群" class="headerlink" title="实战：部署Redis集群"></a>实战：部署Redis集群</h3><p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/43709643b2d36ce19323f02b1bf484b0.png" alt="img"></p>
<p>测试六台服务器的集群，r-m3宕机，r-s3替补</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 通过脚本创建六个redis配置<br><span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> $(seq <span class="hljs-number">1</span> <span class="hljs-number">6</span>); \<br><span class="hljs-keyword">do</span> \<br><span class="hljs-built_in">mkdir</span> -p /mydata/redis/node-$&#123;port&#125;/conf<br>touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf<br>port <span class="hljs-number">6379</span><br>bind <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br>cluster-enabled yes<br>cluster-config-file nodes.conf<br>cluster-node-timeout <span class="hljs-number">5000</span><br>cluster-announce-ip <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>$&#123;port&#125;<br>cluster-announce-port <span class="hljs-number">6379</span><br>cluster-announce-bus-port <span class="hljs-number">16379</span><br>appendonly yes<br>EOF<br>done <br><br># 创建结点<br><span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> $(seq <span class="hljs-number">1</span> <span class="hljs-number">6</span>); \<br><span class="hljs-keyword">do</span> \<br>docker run -p <span class="hljs-number">637</span>$&#123;port&#125;:<span class="hljs-number">6379</span> -p <span class="hljs-number">1637</span>$&#123;port&#125;:<span class="hljs-number">16379</span> --name redis-$&#123;port&#125; \<br>-v /mydata/redis/node-$&#123;port&#125;/data:/data \<br>-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \<br>-d --<span class="hljs-built_in">net</span> redis --ip <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>$&#123;port&#125; redis:<span class="hljs-number">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">9</span>-alpine3.<span class="hljs-number">11</span> redis-server /etc/redis/redis.conf<br><br>done <br><br>[root@localhost ~]# docker exec -it redis-<span class="hljs-number">1</span> /bin/sh<br>/data # redis-cli --cluster create <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">11</span>:<span class="hljs-number">6379</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>:<span class="hljs-number">6379</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">13</span>:<span class="hljs-number">6379</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">14</span>:<span class="hljs-number">6379</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">15</span>:<span class="hljs-number">6379</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">16</span>:<span class="hljs-number">6379</span><br> --cluster-replicas <span class="hljs-number">1</span><br>&gt;&gt;&gt; Performing hash slots allocation on <span class="hljs-number">6</span> nodes...<br>Master[<span class="hljs-number">0</span>] -&gt; Slots <span class="hljs-number">0</span> - <span class="hljs-number">5460</span><br>Master[<span class="hljs-number">1</span>] -&gt; Slots <span class="hljs-number">5461</span> - <span class="hljs-number">10922</span><br>Master[<span class="hljs-number">2</span>] -&gt; Slots <span class="hljs-number">10923</span> - <span class="hljs-number">16383</span><br>Adding replica <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">15</span>:<span class="hljs-number">6379</span> to <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">11</span>:<span class="hljs-number">6379</span><br>Adding replica <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">16</span>:<span class="hljs-number">6379</span> to <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>:<span class="hljs-number">6379</span><br>Adding replica <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">14</span>:<span class="hljs-number">6379</span> to <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">13</span>:<span class="hljs-number">6379</span><br><span class="hljs-function">M: 259<span class="hljs-title">ef84d4826a362bdc73ad25345513c9ebf9447</span> 172.38.0.11:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[0-5460] (5461 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function"><span class="hljs-title">M</span>: 911<span class="hljs-title">abefbfae1d70df6d76003c361f25878ce0e77</span> 172.38.0.12:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[5461-10922] (5462 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function"><span class="hljs-title">M</span>: 5<span class="hljs-title">bec694e52aa2bae43dc2755e325e1b0aaf87552</span> 172.38.0.13:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[10923-16383] (5461 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">e240a6400ca97fc7de11d9d356e88bcc51515508</span> 172.38.0.14:6379</span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 5<span class="hljs-title">bec694e52aa2bae43dc2755e325e1b0aaf87552</span></span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">fd596021d140108df6dda7f2cbcf76261e7aa74f</span> 172.38.0.15:6379</span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 259<span class="hljs-title">ef84d4826a362bdc73ad25345513c9ebf9447</span></span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">fcd076bcd8314f935c1d1b99c47bf5a7b444e443</span> 172.38.0.16:6379</span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 911<span class="hljs-title">abefbfae1d70df6d76003c361f25878ce0e77</span></span><br><span class="hljs-function"><span class="hljs-title">Can</span> <span class="hljs-title">I</span> <span class="hljs-title">set</span> <span class="hljs-title">the</span> <span class="hljs-title">above</span> <span class="hljs-title">configuration</span>? (<span class="hljs-title">type</span> &#x27;<span class="hljs-title">yes</span>&#x27; <span class="hljs-title">to</span> <span class="hljs-title">accept</span>): <span class="hljs-title">yes</span></span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Nodes</span> <span class="hljs-title">configuration</span> <span class="hljs-title">updated</span></span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Assign</span> <span class="hljs-title">a</span> <span class="hljs-title">different</span> <span class="hljs-title">config</span> <span class="hljs-title">epoch</span> <span class="hljs-title">to</span> <span class="hljs-title">each</span> <span class="hljs-title">node</span></span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Sending</span> <span class="hljs-title">CLUSTER</span> <span class="hljs-title">MEET</span> <span class="hljs-title">messages</span> <span class="hljs-title">to</span> <span class="hljs-title">join</span> <span class="hljs-title">the</span> <span class="hljs-title">cluster</span></span><br><span class="hljs-function"><span class="hljs-title">Waiting</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">cluster</span> <span class="hljs-title">to</span> <span class="hljs-title">join</span></span><br><span class="hljs-function">...</span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Performing</span> <span class="hljs-title">Cluster</span> <span class="hljs-title">Check</span> (<span class="hljs-title">using</span> <span class="hljs-title">node</span> 172.38.0.11:6379)</span><br><span class="hljs-function"><span class="hljs-title">M</span>: 259<span class="hljs-title">ef84d4826a362bdc73ad25345513c9ebf9447</span> 172.38.0.11:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[0-5460] (5461 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function">   1 <span class="hljs-title">additional</span> <span class="hljs-title">replica</span>(<span class="hljs-title">s</span>)</span><br><span class="hljs-function"><span class="hljs-title">M</span>: 911<span class="hljs-title">abefbfae1d70df6d76003c361f25878ce0e77</span> 172.38.0.12:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[5461-10922] (5462 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function">   1 <span class="hljs-title">additional</span> <span class="hljs-title">replica</span>(<span class="hljs-title">s</span>)</span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">fcd076bcd8314f935c1d1b99c47bf5a7b444e443</span> 172.38.0.16:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>: (0 <span class="hljs-title">slots</span>) <span class="hljs-title">slave</span></span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 911<span class="hljs-title">abefbfae1d70df6d76003c361f25878ce0e77</span></span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">fd596021d140108df6dda7f2cbcf76261e7aa74f</span> 172.38.0.15:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>: (0 <span class="hljs-title">slots</span>) <span class="hljs-title">slave</span></span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 259<span class="hljs-title">ef84d4826a362bdc73ad25345513c9ebf9447</span></span><br><span class="hljs-function"><span class="hljs-title">S</span>: <span class="hljs-title">e240a6400ca97fc7de11d9d356e88bcc51515508</span> 172.38.0.14:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>: (0 <span class="hljs-title">slots</span>) <span class="hljs-title">slave</span></span><br><span class="hljs-function">   <span class="hljs-title">replicates</span> 5<span class="hljs-title">bec694e52aa2bae43dc2755e325e1b0aaf87552</span></span><br><span class="hljs-function"><span class="hljs-title">M</span>: 5<span class="hljs-title">bec694e52aa2bae43dc2755e325e1b0aaf87552</span> 172.38.0.13:6379</span><br><span class="hljs-function">   <span class="hljs-title">slots</span>:[10923-16383] (5461 <span class="hljs-title">slots</span>) <span class="hljs-title">master</span></span><br><span class="hljs-function">   1 <span class="hljs-title">additional</span> <span class="hljs-title">replica</span>(<span class="hljs-title">s</span>)</span><br><span class="hljs-function">[<span class="hljs-title">OK</span>] <span class="hljs-title">All</span> <span class="hljs-title">nodes</span> <span class="hljs-title">agree</span> <span class="hljs-title">about</span> <span class="hljs-title">slots</span> <span class="hljs-title">configuration</span>.</span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Check</span> <span class="hljs-title">for</span> <span class="hljs-title">open</span> <span class="hljs-title">slots</span>...</span><br><span class="hljs-function">&gt;&gt;&gt; <span class="hljs-title">Check</span> <span class="hljs-title">slots</span> <span class="hljs-title">coverage</span>...</span><br><span class="hljs-function">[<span class="hljs-title">OK</span>] <span class="hljs-title">All</span> 16384 <span class="hljs-title">slots</span> <span class="hljs-title">covered</span>.</span><br><span class="hljs-function"></span><br><span class="hljs-function">#至此<span class="hljs-title">docker</span>搭建<span class="hljs-title">redis</span>集群完成！</span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure>

<p>测试节点宕机，从节点提供服务</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cmd">#进入redis-<span class="hljs-number">1</span><br>[root@localhost ~]# docker exec -it redis-<span class="hljs-number">1</span><br>#查看集群信息<br><span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">11</span>:<span class="hljs-number">6379</span>&gt; cluster nodes<br><span class="hljs-number">259</span>ef84d4826a362bdc73ad25345513c9ebf9447 <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">11</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> myself,master - <span class="hljs-number">0</span> <span class="hljs-number">1737557695000</span> <span class="hljs-number">1</span> connected <span class="hljs-number">0</span>-<span class="hljs-number">5460</span><br><span class="hljs-number">911</span>abefbfae1d70df6d76003c361f25878ce0e77 <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> slave fcd076bcd8314f935c1d1b99c47bf5a7b444e443 <span class="hljs-number">0</span> <span class="hljs-number">1737557695528</span> <span class="hljs-number">7</span> connected<br>fcd076bcd8314f935c1d1b99c47bf5a7b444e443 <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">16</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> master - <span class="hljs-number">0</span> <span class="hljs-number">1737557695000</span> <span class="hljs-number">7</span> connected <span class="hljs-number">5461</span>-<span class="hljs-number">10922</span><br>fd596021d140108df6dda7f2cbcf76261e7aa74f <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">15</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> slave <span class="hljs-number">259</span>ef84d4826a362bdc73ad25345513c9ebf9447 <span class="hljs-number">0</span> <span class="hljs-number">1737557694514</span> <span class="hljs-number">5</span> connected<br>e240a6400ca97fc7de11d9d356e88bcc51515508 <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">14</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> slave <span class="hljs-number">5</span>bec694e52aa2bae43dc2755e325e1b0aaf87552 <span class="hljs-number">0</span> <span class="hljs-number">1737557694109</span> <span class="hljs-number">4</span> connected<br><span class="hljs-number">5</span>bec694e52aa2bae43dc2755e325e1b0aaf87552 <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">13</span>:<span class="hljs-number">6379</span>@<span class="hljs-number">16379</span> master - <span class="hljs-number">0</span> <span class="hljs-number">1737557695629</span> <span class="hljs-number">3</span> connected <span class="hljs-number">10923</span>-<span class="hljs-number">16383</span><br><br>#设置a的值<br><span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">15</span>:<span class="hljs-number">6379</span>&gt; <span class="hljs-built_in">set</span> a bbb<br>-&gt; Redirected to slot [<span class="hljs-number">15495</span>] located <span class="hljs-built_in">at</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">13</span>:<span class="hljs-number">6379</span><br><br>停用redis-<span class="hljs-number">3</span>的容器服务<br><span class="hljs-number">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">6379</span>&gt; get a<br>-&gt; Redirected to slot [<span class="hljs-number">15495</span>] located <span class="hljs-built_in">at</span> <span class="hljs-number">172</span>.<span class="hljs-number">38</span>.<span class="hljs-number">0</span>.<span class="hljs-number">14</span>:<span class="hljs-number">6379</span><br>&quot;bbb&quot;<br></code></pre></td></tr></table></figure>



<p><img src="/images/docker-docker-compose%E5%9F%BA%E7%A1%80/image-20250122225932814.png" alt="image-20250122225932814"></p>
<h1 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h2 id="YAML规则"><a href="#YAML规则" class="headerlink" title="YAML规则"></a>YAML规则</h2><h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" rel="tag"># 计算机基础</a>
              <a href="/tags/docker/" rel="tag"># docker</a>
              <a href="/tags/vmware/" rel="tag"># vmware</a>
              <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag"># 虚拟机</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/12/22/docker%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%AE%89%E8%A3%85/" rel="prev" title="docker使用及安装">
      <i class="fa fa-chevron-left"></i> docker使用及安装
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">Docker基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.1.</span> <span class="nav-text">Docker是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8Docker"><span class="nav-number">1.2.</span> <span class="nav-text">为什么使用Docker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.3.</span> <span class="nav-text">Docker和虚拟机的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E6%80%8E%E4%B9%88%E7%94%A8"><span class="nav-number">1.4.</span> <span class="nav-text">Docker怎么用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="nav-number">1.4.1.</span> <span class="nav-text">docker核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%EF%BC%88image%EF%BC%89"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">镜像（image）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%EF%BC%88container%EF%BC%89"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">容器（container）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%93%E5%BA%93%EF%BC%88repository%EF%BC%89"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">仓库（repository）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.4.2.</span> <span class="nav-text">docker底层原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">docker如何工作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%94VM%E5%BF%AB"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">docker为什么比VM快</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E5%AE%89%E8%A3%85%E5%8F%8A%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE"><span class="nav-number">1.4.3.</span> <span class="nav-text">docker安装及镜像仓库配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.5.</span> <span class="nav-text">Docker常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="nav-number">1.5.1.</span> <span class="nav-text">帮助命令：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">1.5.2.</span> <span class="nav-text">镜像命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.5.3.</span> <span class="nav-text">容器命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E9%83%A8%E7%BD%B2%E8%BD%AF%E4%BB%B6%E5%AE%9E%E6%88%98"><span class="nav-number">1.6.</span> <span class="nav-text">Docker部署软件实战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85Nginx"><span class="nav-number">1.6.1.</span> <span class="nav-text">1、安装Nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E5%AE%89%E8%A3%85Tomcat"><span class="nav-number">1.6.2.</span> <span class="nav-text">2、安装Tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81ES-Kibana"><span class="nav-number">1.6.3.</span> <span class="nav-text">3、ES+Kibana</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="nav-number">1.7.</span> <span class="nav-text">镜像讲解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.8.</span> <span class="nav-text">容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.8.1.</span> <span class="nav-text">什么是容器数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">1.8.2.</span> <span class="nav-text">使用数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E5%AE%89%E8%A3%85MySQL"><span class="nav-number">1.8.2.1.</span> <span class="nav-text">实战：安装MySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B7%E5%90%8D%E6%8C%82%E8%BD%BD%E4%B8%8E%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="nav-number">1.8.2.2.</span> <span class="nav-text">具名挂载与匿名挂载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AAmysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">1.8.2.3.</span> <span class="nav-text">多个mysql同步数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dockerfile%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.9.</span> <span class="nav-text">Dockerfile介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8dockerfile"><span class="nav-number">1.9.1.</span> <span class="nav-text">如何使用dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dockerfile%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">1.9.2.</span> <span class="nav-text">dockerfile搭建过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="nav-number">1.9.3.</span> <span class="nav-text">docker基本命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%89%93%E5%8C%85Docker%E9%95%9C%E5%83%8F"><span class="nav-number">1.9.4.</span> <span class="nav-text">SpringBoot微服务打包Docker镜像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E7%BD%91%E7%BB%9C"><span class="nav-number">1.10.</span> <span class="nav-text">Docker网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#link%EF%BC%88%E4%B8%8D%E9%80%82%E7%94%A8%E5%BD%93%E5%89%8D%EF%BC%89"><span class="nav-number">1.10.1.</span> <span class="nav-text">link（不适用当前）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="nav-number">1.10.2.</span> <span class="nav-text">自定义网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C-1"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">自定义网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">网络连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">结论</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E9%83%A8%E7%BD%B2Redis%E9%9B%86%E7%BE%A4"><span class="nav-number">1.10.3.</span> <span class="nav-text">实战：部署Redis集群</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-Compose"><span class="nav-number">2.</span> <span class="nav-text">Docker Compose</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">2.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">2.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#YAML%E8%A7%84%E5%88%99"><span class="nav-number">2.3.</span> <span class="nav-text">YAML规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">2.4.</span> <span class="nav-text">实战</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="24khandsome"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">24khandsome</p>
  <div class="site-description" itemprop="description">24khandsome's Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">89</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">79</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">24khandsome</span>
  
	<br/>
	<span id="busuanzi_container_site_pv">
		<span class="post-meta-item-icon">
			<i class="fa fa-user"></i>
		</span>
		访问量：<span id="busuanzi_value_site_pv"></span> 次数
	</span>

	<span class="post-meta-divider">|</span>
		<span id="busuanzi_container_site_uv">
			<i class="fa fa-eye"></i>
			访客数：<span id="busuanzi_value_site_uv"></span> 人次
	</span>

</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
<!-- 动态背景 -->
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</html>
